
<html lang="en"><!-- Apertura de la pagina html -->
<head><!-- Encabezado de la pagina html -->
    <meta charset="UTF-8"><!-- Codificacion de Caracteres especiales  -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!-- IE -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <title>REGISTRO DE CLIENTES</title>
</head>
<body><!-- Contenido de la pagina html -->
    <div class="container" id="app">
        <div class="row p-2 ">
            <div class="col-12 col-md-6">
                <div style="width: 60rem;" class="card border-primary">
                    <div class="card-header bg-primary text-white" style="width: 60rem;">books register</div>
                    <div class="card-body">
                        <form id="frmLibro" @submit.prevent="guardarCliente" @reset.prevent="nuevoCliente()">
                            <div class="row p-1">
                                <div class="col-3 col-md-2">CODIGO: </div>
                                <div class="col-9 col-md-6">
                                    <input class="form-control" type="text" v-model="cliente.codigo" name="txtCodigoAutor" id="txtCodigoAutor">
                                </div>
                            </div>
                            <div class="row p-1">
                                <div class="col-3 col-md-2">NOMBRE: </div>
                                <div class="col-9 col-md-6">
                                    <input class="form-control" type="text" v-model="cliente.nombre" name="txtClienteNombre" id="txtClienteNombre">
                                </div>
                            </div>

                            <div class="row p-1">
                                <div class="col-3 col-md-2">DIRECCION: </div>
                                <div class="col-9 col-md-6">
                                    <input class="form-control" type="text" v-model="cliente.direccion" name="txtDireccionCliente" id="txtDireccionCliente">
                                </div>
                            </div>
                            <div class="row p-1">
                                <div class="col-3 col-md-2">ZONA </div>
                                <div class="col-9 col-md-6">
                                    <input class="form-control" type="text" v-model="cliente.zona" name="txtZonaCliente" id="txtZonaCliente">
                                </div>
                            
                            
                            <div class="row p-6">
                                <div class="col-3 col-md-3">
                                <br>
                                    <input class="btn btn-success" type="submit" value="Guardar Datos">
                                </div>

                                <div class="col-3 col-md-3">
                                <br>
                                    <input class="btn btn-warning" type="reset" value="Nuevo Registro">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-body">
        <form>
           <br>
            <table class="table table-dark table-striped">
                <thead>
                    <tr>
                        <th>BUSCAR:</th>

                        <th colspan="8"><input type="text" @keyup="listarClientes()" v-model="buscar" 
                            class="form-control" placeholder="Buscar por nombre" ></th>
                    </tr>
                    <tr>
                        <th>CODIGO:</th>
                        <th colspan="1">NOMBRE:</th>
                        <th colspan="1">DIRECCION:</th>
                        <th colspan="2">ZONA:</th>
                        


                       

                    </tr>
                </thead>
                <tbody>
                    <tr v-for="cliente in clientes" @click='modificarCliente(cliente)' :key="cliente.idCliente">
                        <td>{{cliente.codigo}}</td>
                        <td>{{cliente.nombre}}</td>
                        <td>{{cliente.direccion}}</td>
                        <td>{{cliente.zona}}</td>
                        
                       
                        <td><button @click.prevent="eliminarCliente(cliente)" class="btn btn-danger">Eliminar</button></td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
    const { createApp } = Vue;
        createApp({
            data() {
                return {
                    buscar: '',
                    clientes:[],
                    accion : 'nuevo',
                    cliente:{
                        idCliente:0,
                        codigo:'',
                        nombre:'',
                        direccion:'',
                        zona:''
                        
                        
                    }
                }
            },
            methods:{
                nuevoCliente(){
                    this.accion = 'nuevo';
                    this.cliente.idCliente = '';
                    this.cliente.codigo = '';
                    this.cliente.nombre = '';
                    this.cliente.direccion = '';
                    this.cliente.zona = '';
                    

                   
                },
                modificarCliente(cliente){
                    this.accion = 'modificar';
                    this.cliente = cliente;
                },
                guardarCliente(){
                    this.listarClientes();
                    if( this.accion==='nuevo' ){
                        this.cliente.idCliente = new Date().getTime().toString(16);//las cantidad milisegundos y lo convierte en hexadecimal
                        this.clientes.push( JSON.parse(JSON.stringify(this.cliente)) );
                    }else if(this.accion==='modificar'){
                        //hacer la busqueda y modificar el registro
                        let index = this.clientes.findIndex(cliente=>cliente.idCliente==this.cliente.idCliente);
                        this.clientes[index] = JSON.parse(JSON.stringify(this.cliente));
                    }else if(this.accion==='eliminar'){
                        let index = this.clientes.findIndex(cliente=>cliente.idClientes==this.cliente.idCliente);
                        this.clientes.splice(index, 1);
                    }
                    localStorage.setItem('clientes', JSON.stringify(this.clientes));
                    this.nuevoCliente();
                },
                eliminarCliente(cliente){
                    if( confirm(`Esta seguro de eliminar este cliente${cliente.nombre}?`) ){
                        this.accion="eliminar";
                        this.cliente = cliente;
                        this.guardarCliente();
                    }
                },
                listarClientes(){
                    this.clientes = JSON.parse( localStorage.getItem('clientes') || "[]" )
                        .filter(cliente=>cliente.nombre.toLowerCase().indexOf(this.buscar.toLowerCase())>-1)||
                                    cliente.codigo.indexOf(this.buscar)>-1;
                }
            },
            created(){
                this.listarClientes();
            }
        }).mount('#app')
    </script>
